<!doctype html>
 
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Tracelyzer</title>
  <link rel="stylesheet" href="lib/themes/base/jquery-ui.css" />
  <link rel="stylesheet" href="jquery.ui.menubar.css" />
  <script src="lib/jquery-1.9.1.js"></script>
  <script src="lib/ui/jquery-ui.js"></script>
	<script src="jquery.ui.menubar.js"></script>
	<script src="jquery.mousewheel.min.js"></script>
  <script src="viz.js"></script>
  <script src="raphael-min.js"></script>

  <script src="app.js"></script>
  <link rel="stylesheet" href="lib/themes/base/jquery.ui.all.css" />
  <style>
  #memView { width: 450px; height: 130px; padding: 0.5em; float: left; }
  #graphView { height: 150px; padding: 0.5em; float: left; }
  #timeslider { margin: 10px; }
  #hexView {font-family: monospace; float: left; }
  #asciiView {font-family: monospace; float: left;}
  #instrContents {float: left; font-family:monospace; font-size: 8pt; }
  #cpuState {float: left; font-family:monospace; font-size: 8pt; }
  #cpuState2 {float: left; font-family:monospace; font-size: 8pt; }
  #memoryLinks {left-padding: 150px; float: left;}
  .description { font-size: 10pt; }
  .smallButton { font-size: 10pt; }
 .aTop { font-size: 10pt; }
 .readMemLink {color: green; font-family: monospace;  }
 .writeMemLink {color: red; font-family: monospace;}
  </style>
</head>
<body>

<div style="margin-bottom: 10px;">
<ul id="menu" class="menubar" style="font-size: 10pt">
	<li><a href="#">File</a>
		<ul>
		
			<li>
				<a href="#">Open trace</a>
				<ul id="tracesToLoad">
					<!-- This will be filled by JavaScript code -->
				</ul>

			</li>
		</ul>
	</li>
</ul>
</div>

<div style="clear:both; top: 80%">


<div id="timeView" class="ui-widget-content" >
<div class="ui-widget-header">Global time control</div>

<button id="timeJump" class="smallButton">Jump to time</button>
<div id="timeslider"></div> 
 </div>
</div>


<div style="clear: both"></div>

<div id="accordion">
	<h3 class="aTop">General trace info</h3>
	<div class="ui-widget-content">
		<div id="generalInfo">
		Loading...
		</div>
	</div>

	<h3 class="aTop">CPU view: Instructions and CPU state</h3>
	<div id="instrView" class="ui-widget-content">
		<p class="description">This view shows the most recently executed instructions and a couple of instructions executed before it. On the right two database dumps are shown from different versions of the engine. The engine uses notation tttt/iiiiiiiii, where tttt = timestamp and iiiii = address of instruction.
		<div>
		<textarea id="instrContents" rows="20" cols="40"></textarea>
		<textarea id="cpuState" rows="20" cols="40"></textarea>
		<!-- <textarea id="cpuState2" rows="30" cols="40"></textarea> -->
		<div id="memoryLinks"></div>
		</div>
	</div>
	<h3 class="aTop">Memory access overview: Visualize direct memory accesses</h3>
	<div id="rwGraph" class="ui-widget-content">
		<p class="description">
			This view is used to visualize all memory reads and writes accessing a given memory range. Read accesses are colored green and write accesses red. Click on a memory access to move the time slider to the instruction that caused the access and check CPU view.<br/>
			Computational complexity: O(n log m + n log n + C), where n = number of memory locations; m = maximum number of memory oprerations to a single location in the range;  C = size of output i.e. the amount of squares 
		</p>
		<button id="btnRW">Draw</button>
		<div id="rwGraphCanvas"></div>
	</div>

	<h3 class="aTop">Taint visualization: (file format/structure RE)</h3>
	<div id="readGraph" class="ui-widget-content">
		<p class="description">
		This mode of analysis works as follows. We begin by marking a certain memory range of interest as "tainted". Thereafter 10 000 instructions are traced to determine if they access tainted regions. If an instruction accesses a tainted value, dataflow analysis is used to mark the regions affected by this data tainted as well. Moreover, any access to a tainted value is traced back to the original memory location and this information is then used to draw the graph. The main use case is to investigate unknown file formats / data structures.
		</p>
	<p class ="description">
		The y axis represents time and is compressed so that each access to the exact same set of bytes constitutes only one "time step". Color is determined based on a hash of instruction pointer values during times of access. Same color thus indicates the same set of instructions. The x axis represents memory addresses. Complexity: O(n), where n = number of instructions/cycles, the constant factor is large.
	</p>
		<button id="btnForwardTaint">Draw</button>
		<div id="readGraphCanvas"></div>
	</div>

	<h3 class="aTop">Dataflow graph: Where does this value originate from? (use by clicking a hex value in the memory dump)</h3>
	<div id="graphView" class="ui-widget-content"  >
		<div style="width:900px;clear:both;"></div>
		<div id="graph" style="width: 100%; height: 400px;"></div>
	</div>

</div>
<!-- Dialogs -->
<div id="jumpToForm" title="Jump to a point in time">
	<form>
	<fieldset>
	<label for="txtTargetTime">Time</label>
	<input type="text" name="txtTargetTime" id="txtTargetTime"></input>
	</fieldset>
	</form>
</div>

<div id="dlgRWGraph" title="Memory access overview">
	<fieldset>

		<label for="txtAddressRW">Address (hex)</label>
		<input type="text" name="txtAddressRW" id="txtAddressRW"></input>

		<label for="txtBytesRW">Byte count (dec)</label>
		<input type="text" name="txtBytesRW" id="txtBytesRW" value="100"></input>

		<label for="chkCompress">Compress unused addresses</label>
		<input type="checkbox" name="chkCompress" id="chkCompress" checked="true" /><br/>

		<label for="txtTimeTW">Start time of analysis</label>
		<input type="text" name="txtTimeRW" id="txtTimeRW" value="0"></input>

		<label for="txtCyclesRW">Number of cycles to analyze (dec)</label>
		<input type="text" name="txtCyclesRW" id="txtCyclesRW" value="50000"></input>

	</fieldset>

</div>

<div id="dlgForwardTaint" title="Forward taint analysis">
	<p class="description">
	This features enables you to see a visualization of how the program
	accesses a certain piece of data.
	</p>
	<form>
	<fieldset>

	<label for="txtAddress">Address (hex)</label>
	<input type="text" name="txtAddress" id="txtAddress"></input>


	<label for="txtTime">Start time of analysis</label>
	<input type="text" name="txtTime" id="txtTime" value="0"></input>

	</fieldset>
	</form>
</div>
<div id="dlgSetMemAddr" title="Memory address">
	<p class="description">
		Set a memory address to monitor.
</p>
	<form>
	<fieldset>

	<label for="txtMemAddr">Address (hex)</label>
	<input type="text" name="txtMemAddr" id="txtMemAddr"></input>


	</fieldset>
	</form>
</div>
<!-- /Dialogs -->

<div style="clear: both"></div>
<div id="memView" class="ui-widget-content" >
	<div class="ui-widget-header">Memory dump</div>
	<input type="button" id="btnSetAddr" value="Set address"/>
	<div style="clear:both;"></div>
	<div id="hexView" style="float:left;"></div>
	<div id="asciiView" style="float:left;"></div>
</div>



</body>
</html>
